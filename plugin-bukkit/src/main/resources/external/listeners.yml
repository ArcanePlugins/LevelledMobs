## LevelledMobs 4 Brainstorming File
# This is LM 4's listeners file. The contents of this file are not final - just brainstorming.
# LM 3's rules file is available at: https://github.com/lokka30/LevelledMobs/blob/master/src/main/resources/rules.yml

## LISTENERS SYSTEM
# Major change to the rules system. Everything is now processed based
# upon an event that happened on the server.
# The first listener specified in the event-listeners section
# adds a new listener for the event 'EntitySpawnEvent'.
# This processes any mob involved in such event.
# Note - LM needs to add its own support for each event
# it allows to be listened to. So we can't just use any
# random event, only the ones LM has been programmed to
# be able to use.

## RULE PROCESSING ORDER
# Rules are processed from top to bottom
# If a rule below another rule both modify the same value then the lower rule will override the upper one
# The 'default rule' no longer exists

## CLUSTERS
# Rules can be put inside clusters.
# Clusters can also be nested inside each other.
# Clusters allow for rules to be organised
# and disabled all in one switch if required
# Each rule within groups can still be enabled
# or disabled but if the cluster is disabled then
# that takes priority.
# Clusters are not used by default as to not confuse users.

event-listeners:

  level-mobs-on-spawn-listener:
    description: 'Level mobs when they spawn in'
    options:
      listen-for: ['entity-spawn']

    rules:
      no-levels-from-spawners:
        enabled: true
        description: 'Mobs spawned by spawner blocks will not be levelled'
        conditions:
          spawn-reason:
            inclusive-list: ['SPAWNER']
        use-presets: ['no-level']

      no-levels-from-certain-worlds:
        enabled: true
        description: 'Mobs spawned in specific world(s) will not be levelled'
        conditions:
          world:
            inclusive-list: ['world_the_end']
        use-presets: ['no-level']

      no-levels-for-passives-or-bosses:
        enabled: true
        description: 'Passive and boss mobs will not be levelled'
        conditions:
          mob-group:
            inclusive-list: ['passives', 'bosses']
        use-presets: ['no-level']

      no-levels-for-baby-hostile-mobs:
        enabled: true
        description: 'Baby hostile mobs will not be levelled'
        conditions:
          mob-group:
            inclusive-list: ['hostiles']
          baby-mob: true
        use-presets: ['no-level']

      no-levels-for-mobs-belonging-to-other-plugins:
        enabled: true
        description: 'Prevents LM from making mobs levelled if they belong to other plugins e.g. Citizens or MythicMobs'
        conditions:
          mob-owner:
            inclusive-list: []

      apply-level-and-attributes-and-nametag:
        enabled: true
        description: 'Apply a level (from difficulty preset), a nametag, and attributes to levelled mobs'
        actions:
          nametags:
            format: '[Example Nametag Lvl. %entity-level% %entity-name% %current-health%/%max-health%]'
            visibility-duration: 1
            visibility-method: ['TARGETED', 'ATTACKED']
          matched-settings:
            babies: true
            passengers: false
          execute: ['update-nametag']
        use-presets: ['normal-difficulty']

  # When an entity takes damage, update their nametag.
  # The 'update-nametag' executable, when called on an entity,
  # scans for nearby players and sends them an updated packet
  # of the mob's nametag.
  # When a player joins the server, mobs nearby them have
  # their nametags updated. This means that the packet is
  # sent to the player.
  # When the executable 'update-nametag' is called on a player
  # instead of an entity, it scans for nearby entities and
  # updates all of their nametags.
  update-nametag-listener:
    options:
      listen-for: ['entity-damage', 'entity-regain-health', 'player-join', 'player-teleport', 'player-change-world']
    rules:
      update-nametag:
        enabled: true
        conditions:
          is-levelled: true
        actions:
          execute: ['update-nametag']

# Don't touch any of this unless you know what you're doing,
# or, unless a LevelledMobs maintainer suggested you do so.
file-metadata:
  version: 1