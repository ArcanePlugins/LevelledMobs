# LM 3's rules file is available at: https://github.com/lokka30/LevelledMobs/blob/master/src/main/resources/rules.yml
  
# Major change to the rules system. Everything is now processed based
# upon an event that happened on the server.
event-listeners:

# Adds a new listener for the event 'EntitySpawnEvent'
# Note - LM needs to add its own support for each event
# it allows to be listened to. So we can't just use any
# random event, only the ones LM has been programmed to
# be able to use.
  - listener-id: 'level-mobs-on-spawn'

    description: 'Level mobs when they spawn in'

#   Change options of the listener here.
    options:

#     What event should this listener be listening to?
      listen-for: ['entity-spawn']

#     If another plugin cancels the event,
#     should LM not process any rules for this listener?
#     Enabled by default but included for showcase purposes.
      ignore-cancelled: true
    
#   Rules are processed from top to bottom
#   If a rule below another rule both modify the same value then the lower rule will override the upper one
    rules:

#     Rules can be put under groups.
#     Groups can also be nested inside each other.
#     Groups allow for rules to be organised
#     and disabled all in one switch if required
#     Each rule within groups can still be enabled
#     or disabled but if the group is disabled then
#     that takes priority.
      - group-id: 'generic-levelling-conditions'
        enabled: true
        description: 'Conditions that mobs have to satisfy in order to be levelled'
        rules:
          - rule-id: 'no-levels-from-spawners'
            enabled: true
            description: 'Mobs spawned by spawner blocks will not be levelled'
            conditions:
              spawn-reason:
                inclusive-list: ['SPAWNER']
            use-presets: ['no-level']

          - rule-id: 'no-levels-from-certain-worlds'
            enabled: true
            description: 'Mobs spawned in specific world(s) will not be levelled'
            conditions:
              world:
                inclusive-list: ['world_the_end']
            use-presets: ['no-level']

          - rule-id: 'no-levels-for-certain-mobs'
            enabled: true
            description: 'Certain mobs and groups of mobs will not be levelled'
            conditions:
              in-mob-group: ['animals', 'bosses']
            use-presets: ['no-level']

      - group-id: 'generic-levelled-mob-actions'
        enabled: true
        description: 'Apply various levelling actions to mobs that should be levelled.'
        rules:
          - rule-id: 'apply-level-and-attributes-and-nametag'
            enabled: true
            description: 'Apply a level (from difficulty preset), a nametag, and attributes to levelled mobs'
            actions:
              nametags:
                format: '[Example Nametag Lvl. %entity-level% %entity-name% %current-health%/%max-health%]'
                visibility-duration: 1 # seconds instead of milliseconds
                visibility-method: ['TARGETED', 'ATTACKED']
              matched-settings:
                babies: true
                passengers: false
              execute: ['update-nametag']
            use-presets: ['normal-difficulty']

# When an entity takes damage, update their nametag.
# The 'update-nametag' executable, when called on an entity,
# scans for nearby players and sends them an updated packet
# of the mob's nametag.
# When a player joins the server, mobs nearby them have
# their nametags updated. This means that the packet is
# sent to the player.
# When the executable 'update-nametag' is called on a player
# instead of an entity, it scans for nearby entities and
# updates all of their nametags.
  - listener-id: 'update-nametag'
    options:
      listen-for: ['entity-damage', 'entity-regain-health', 'player-join', 'player-teleport', 'player-change-world']
    rules:
      - rule-id: 'update-nametag'
        enabled: true
        conditions:
          is-levelled: true
        actions:
          tasks: ['update-nametag']
      
# Don't touch any of this unless you know what you're doing,
# or, unless a LevelledMobs maintainer suggested you do so.
file-data-do-not-edit:
  version: 1
  generated-with: '${project.version}'