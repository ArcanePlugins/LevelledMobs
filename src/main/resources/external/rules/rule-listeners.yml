# LM 3's rules file is available at: https://github.com/lokka30/LevelledMobs/blob/master/src/main/resources/rules.yml
  
# Major change to the rules system. Everything is now processed based
# upon an event that happened on the server.
listeners:

# Adds a new listener for the event 'EntitySpawnEvent'
# Note - LM needs to add its own support for each event
# it allows to be listened to. So we can't just use any
# random event, only the ones LM has been programmed to
# be able to use.
  - id: 'level-mobs-on-spawn'
    

    # Change options of the listener here.
    options:

#     What event should this listener be listening to?
      event: 'entity-spawn'

#     If another plugin cancels the event,
#     should LM not process any rules for this listener?
#     Enabled by default but included for showcase purposes.
      ignore-cancelled: true
    
    # Rules are processed from top to bottom
    # If a rule below another rule both modify the same value then the lower rule will override the upper one
    rules:

#     Rules can be put under groups.
#     Groups can also be nested inside each other.
#     Groups allow for rules to be organised
#     and disabled all in one switch if required
#     Each rule within groups can still be enabled
#     or disabled but if the group is disabled then
#     that takes priority.
      - id: 'generic-levelled-mob-conditions'
        enabled: true
        rules:
          - id: 'no-levels-from-spawners'
            enabled: true
            conditions:
              spawn-reason:
                inclusive-list: ['SPAWNER']
            use-preset: 'no-level'

          - id: 'no-levels-from-certain-worlds'
            enabled: true
            conditions:
              world:
                inclusive-list: ['world_the_end']
            use-preset: 'no-level'

      - id: 'generic-levelled-mob-actions'
        enabled: true
        rules:
          - id: 'apply-level-and-attributes-and-nametag'
            enabled: true
            actions:     
              name-overrides:
#               '*': '%biome% %name%' # e.g. this will show 'Jungle Creeper'.
              nametags:
                format: '&8[%tiered%Lvl. %level%&r &8| &r%name%&r &8| %tiered%%current-health%&8/%tiered%%max-health% â™¥&8]' # This format is only used for showcase purposes. It's just easier to type
                visibility-duration: 1000
                visibility-method: ['TARGETED', 'ATTACKED'] # Removed 'TRACKING' by default.
              matched-settings:
                babies: true
                passengers: false
              execute: ['update-nametag'] # will explain this executable below.
            use-presets: ['normal-difficulty'] # change the difficulty here

# When an entity takes damage, update their nametag.
# The 'update-nametag' executable, when called on an entity,
# scans for nearby players and sends them an updated packet
# of the mob's nametag.
  - id: 'update-nametag-on-health-decrease'
    options:
      event: 'entity-damage'
    rules:
      - id: 'update-individual-entity-nametag'
        enabled: true
        actions:
          execute: ['update-nametag']
  
# Same as the above listener except runs on health increase / regeneration.
  - id: 'update-nametag-on-health-increase'
    options:
      event: 'entity-regain-health'
    rules:
      - id: 'update-individual-entity-nametag'
        enabled: true
        actions:
          execute: ['update-nametag']

# When a player joins the server, mobs nearby them have
# their nametags updated. This means that the packet is
# sent to the player.
# When the executable 'update-nametag' is called on a player
# instead of an entity, it scans for nearby entities and
# updates all of their nametags.
  - id: 'update-nametag-on-join'
    options:
      event: 'player-join'
    rules:
      - id: 'update-nearby-mob-nametags'
        enabled: true
        actions:
          execute: ['update-nametag']

  - id: 'update-nametag-on-teleport'
    options:
      event: 'player-teleport'
    rules:
      - id: 'update-nearby-mob-nametags'
        enabled: true
        actions:
          execute: ['update-nametag']

  - id: 'update-nametag-on-world-change'
    options:
      event: 'player-change-world'
    rules:
      - id: 'update-nearby-mob-nametags'
        enabled: true
        actions:
          execute: ['update-nametag']
      
# Don't touch any of this unless you know what you're doing,
# or, unless a LevelledMobs maintainer suggested you do so.
file:
  version: '??' #TODO
  generated-with: '${project.version}'